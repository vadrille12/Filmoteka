function e(e,t,n,o){Object.defineProperty(e,t,{get:n,set:o,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},o={},r={},a=n.parcelRequired7c6;null==a&&((a=function(e){if(e in o)return o[e].exports;if(e in r){var t=r[e];delete r[e];var n={id:e,exports:{}};return o[e]=n,t.call(n.exports,n,n.exports),n.exports}var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){r[e]=t},n.parcelRequired7c6=a),a.register("kyEFX",(function(t,n){var o,r;e(t.exports,"register",(function(){return o}),(function(e){return o=e})),e(t.exports,"resolve",(function(){return r}),(function(e){return r=e}));var a={};o=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)a[t[n]]=e[t[n]]},r=function(e){var t=a[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t}})),a.register("cqGDw",(function(t,n){e(t.exports,"fetchTrendingMovies",(function(){return s})),e(t.exports,"fetchTrailer",(function(){return i}));var o=a("6RiD3"),r=a("31u3U");async function s(e=1){try{const t={headers:{"Content-Type":"application/json;charset=utf-8"}},n=await fetch(`${o.TREND_URL}?api_key=${o.API_KEY}&page=${e}`,t),a=await n.json();return(0,r.save)("trending-movies",a),a}catch(e){console.error(e.message)}}async function i(e){try{const t=await fetch(`${o.TRAILER_URL}/${e}/videos?api_key=${o.API_KEY}&language=en-US`);return await t.json()}catch(e){console.log(e.message)}}})),a.register("6RiD3",(function(t,n){e(t.exports,"API_KEY",(function(){return o})),e(t.exports,"BASE_URL",(function(){return r})),e(t.exports,"TREND_URL",(function(){return a})),e(t.exports,"SEARCH_URL",(function(){return s})),e(t.exports,"TRAILER_URL",(function(){return i}));const o="8b20680c766bc5c37143e5d6b7aa7894",r="https://api.themoviedb.org/3",a=`${r}/trending/movie/week`,s=`${r}/search/movie`,i=`${r}/movie`})),a.register("31u3U",(function(t,n){e(t.exports,"load",(function(){return o})),e(t.exports,"save",(function(){return r}));const o=e=>{try{let t=localStorage.getItem(e);return null===t?void 0:JSON.parse(t)}catch(e){console.error("Get state error: ",e.message)}},r=(e,t)=>{try{const n=JSON.stringify(t);localStorage.setItem(e,n)}catch(e){console.error("Set state error: ",e.message)}}})),a.register("bnGUG",(function(n,o){e(n.exports,"waitingLi",(function(){return _}));var r=a("itj1P"),s=a("krGWQ"),i=a("31u3U"),c=a("cqGDw");a("37v9V"),a("37v9V");const d="watched-movies",l="queue-movies";let u=[],m=[];function f(e){const n=Number(e.currentTarget.id);u=(0,i.load)(d),m=(0,i.load)(l),console.log(n);const o=JSON.parse(localStorage.getItem("search-storage")).results;!function({title:e,vote_average:n,vote_count:o,popularity:a,poster_path:i,original_title:c,genre_ids:d,overview:l,id:u}){const m=d.map((e=>localStorage.getItem(e))),f=`  <img\n          class='modal-movie__img'\n\n          ${i?`\n    srcset="\n    https://image.tmdb.org/t/p/w300/${i}      300w,\n    https://image.tmdb.org/t/p/w500/${i}      500w,\n    https://image.tmdb.org/t/p/w780/${i}      780w,\n    https://image.tmdb.org/t/p/w1280/${i}    1280w,\n    https://image.tmdb.org/t/p/original/${i} 2000w\n  "\n  src="https://image.tmdb.org/t/p/w300/${i}"\n  sizes="(min-width:1280px) 375px, (min-width:768px) 264px, 100vw"\n\n  `:`src="${t(r)}"\n  `}\n        />\n        <button type="button" class="btn__open-trailer js-open-trailer"></button>`,v=`\n        <h2 class='modal__title'>${e}</h2>\n          <table class='modal-info'>\n            <tr>${o?"<td class='modal-info__title'>Vote / Votes</td>":""}\n              ${o?`<td class='modal-info__value'>\n                <span class='modal-info__rate'>${n.toFixed(1)}</span>\n                /\n                <span class='modal-info__rate'>${o}</span>\n              </td>`:""}\n            \n            </tr>\n            <tr>\n              ${a?"<td class='modal-info__title'>Popularity</td>":""}\n              ${a?`<td class='modal-info__value'>${a.toFixed(1)}</td>`:""}\n            </tr>\n            <tr>\n              ${c?"<td class='modal-info__title'>Original Title</td>":""}\n              ${c?`<td class='modal-info__value'>${c}</td>`:""}\n            </tr>\n            <tr>\n              ${m.join(", ")?"<td class='modal-info__title'>Genre</td>":""}\n              ${m.join(", ")?`<td class='modal-movie-info__value'>${m.join(", ")}</td>`:""}\n            </tr>\n          </table>\n          <div class='modal-about'>\n            ${l?"<h3 class='modal-about__title'>About</h3>":""}\n            ${l?`<p class='modal-about__desc'>${l}</p>`:""}\n          </div>`;s.refs.modal.setAttribute("data-id",u),s.refs.addWatchedBtn.setAttribute("data-id",u),s.refs.addQueueBtn.setAttribute("data-id",u),s.refs.modalMovie.insertAdjacentHTML("afterbegin",f),s.refs.modalText.insertAdjacentHTML("afterbegin",v)}(u.concat(m).concat(o).find((e=>{if(e.id===n)return e}))),s.refs.backdrop.classList.remove("is-hidden"),s.refs.closeBtn.addEventListener("click",v),s.refs.backdrop.addEventListener("click",v),window.addEventListener("keydown",g),s.refs.addWatchedBtn.addEventListener("click",p),s.refs.addQueueBtn.addEventListener("click",h);u.some((e=>e.id===n))?(s.refs.addWatchedBtn.textContent="remove from watched",s.refs.addWatchedBtn.classList.add("active-watched")):(s.refs.addWatchedBtn.textContent="add to watched",s.refs.addWatchedBtn.classList.remove("active-watched"));m.some((e=>e.id===n))?(s.refs.addQueueBtn.textContent="remove from queue",s.refs.addQueueBtn.classList.add("active-queue")):(s.refs.addQueueBtn.textContent="add to queue",s.refs.addQueueBtn.classList.remove("active-queue"));document.querySelector(".js-open-trailer").addEventListener("click",(async function(e){try{const e=await(0,c.fetchTrailer)(n);if(console.log(e.results.length),e.results.length>0)window.open(`https://www.youtube.com/watch?v=${e.results[0].key}`,"_blank");else{!function(){const e=document.querySelector(".modal-movie");e.insertAdjacentHTML("afterbegin",'<p class="trailer-search form__uncorrect-search is-hidden"></p>');const t=document.querySelector(".form__uncorrect-search");t.textContent="Sorry, but there is no trailer for this movie",setTimeout((()=>{t.classList.toggle("is-hidden")}),1e3),setTimeout((()=>{e.firstElementChild.remove()}),2e3)}()}}catch(e){e.message}}))}function v(e){"btn-modal-close"!==e.target.classList.value&&e.target!==e.currentTarget||(s.refs.backdrop.classList.add("is-hidden"),document.body.style.overflow="",s.refs.closeBtn.removeEventListener("click",v),s.refs.backdrop.removeEventListener("click",v),s.refs.addWatchedBtn.removeEventListener("click",p),s.refs.addQueueBtn.removeEventListener("click",h),window.removeEventListener("keydown",g),s.refs.modalMovie.innerHTML="",s.refs.modalText.innerHTML="")}function g(e){console.log(e.code),"Escape"===e.code&&(s.refs.backdrop.classList.add("is-hidden"),document.body.style.overflow="",s.refs.closeBtn.removeEventListener("click",v),s.refs.backdrop.removeEventListener("click",v),window.removeEventListener("keydown",g),s.refs.addWatchedBtn.removeEventListener("click",p),s.refs.addQueueBtn.removeEventListener("click",h),s.refs.modalMovie.innerHTML="",s.refs.modalText.innerHTML="")}function p(e){const t=document.querySelector(".active-watched");e.target.classList.toggle("active-watched");const n=Number(s.refs.modal.dataset.id),o=JSON.parse(localStorage.getItem("search-storage")).results;if(u=(0,i.load)(d),t){const t=u.filter((e=>e.id!=n));(0,i.save)(d,t),e.target.textContent="add to watched"}t||(o.find((e=>{e.id===n&&(u.push(e),console.log(u),(0,i.save)(d,u),console.log(e))})),e.target.textContent="remove from watched")}function h(e){const t=document.querySelector(".active-queue");e.target.classList.toggle("active-queue");const n=Number(s.refs.modal.dataset.id),o=JSON.parse(localStorage.getItem("search-storage")).results;if(m=(0,i.load)(l),t){const t=m.filter((e=>e.id!=n));(0,i.save)(l,t),e.target.textContent="add to queue"}t||(o.find((e=>{e.id===n&&(m.push(e),console.log(m),(0,i.save)(l,m),console.log(e))})),e.target.textContent="remove from queue")}function _(){setTimeout((()=>{s.refs.cardsList.childNodes.forEach((e=>{e.addEventListener("click",f)}))}),200)}(0,i.load)(d)||(0,i.save)(d,u),(0,i.load)(l)||(0,i.save)(l,m)})),a.register("itj1P",(function(e,t){e.exports=new URL(a("kyEFX").resolve("8iIgb"),import.meta.url).toString()})),a.register("krGWQ",(function(t,n){e(t.exports,"refs",(function(){return o}));const o={body:document.querySelector("body"),form:document.querySelector(".header-form"),watchedBtn:document.querySelector(".watched-list-btn"),paginationEl:document.getElementById("tui-pagination-container"),moviesGallery:document.querySelector(".cards__list--home"),formFilm:document.querySelector(".header-form"),cardsList:document.querySelector(".cards__list"),backdrop:document.querySelector(".backdrop"),modal:document.querySelector(".modal"),modalMovie:document.querySelector(".modal-movie"),modalContent:document.querySelector(".modal__content"),closeBtn:document.querySelector(".btn-modal__icon"),addWatchedBtn:document.querySelector(".btn-modal__watched"),addQueueBtn:document.querySelector(".btn-modal__queue"),modalText:document.querySelector(".modal__text")}})),a.register("37v9V",(function(e,t){a("6RiD3"),a("krGWQ");a("cqGDw")})),a("kyEFX").register(JSON.parse('{"3u2jX":"index.3985ac47.js","8iIgb":"photo.e4714d22.jpg"}'));
//# sourceMappingURL=index.3985ac47.js.map
