{"mappings":"iiBAAAA,EAAA,SAAAC,SAA8CC,KAAKC,MAAM,8L,MCAzDC,EAAiBJ,EAAA,SAAAK,aAA6C,SAAWL,EAAA,SAAAM,QAA6C,S,iECItH,IAAMC,EAAaC,SAASC,cAAc,qBACpCC,EAAWF,SAASC,cAAc,mBACxCE,EAAAC,KAAKC,cAAcC,iBAAiB,SA6FpC,SAAgCC,GAC9B,IAAMC,EAAcC,OAAOF,EAAEG,OAAOC,QAAQC,IACtCC,EAAoBC,EAAgBC,MAAK,SAAAC,GAC7C,GAAIR,IAAgBQ,EAAKJ,GAEvB,OADAK,QAAQC,IAAIF,EAAKJ,IACVI,EAAKJ,E,IAIhBO,EAAmBL,EAAiBD,EAAkBD,IACtDQ,EAAwBN,GACO,IAA3BA,EAAgBO,SAClB,EAAAC,EAAAC,e,IAxGJpB,EAAAC,KAAKoB,YAAYlB,iBAAiB,SA8GlC,SAA8BC,GAC5B,IAAMC,EAAcC,OAAOF,EAAEG,OAAOC,QAAQC,IACtCC,EAAoBY,EAAcV,MAAK,SAAAC,GAC3C,GAAIR,IAAgBQ,EAAKJ,GAEvB,OADAK,QAAQC,IAAIF,EAAKJ,IACVI,EAAKJ,E,IAIhBO,EAAmBM,EAAeZ,EAAkBD,IACpDQ,EAAwBK,GACK,IAAzBA,EAAcJ,SAChB,EAAAC,EAAAC,e,IAzHJxB,EAAWO,iBAAiB,SA+HrB,WACLoB,EAAUC,UAAY,GACS,IAA3Bb,EAAgBO,SAClB,EAAAC,EAAAC,gBAEF,GAAIK,EAAYP,OAAS,EAAG,CAC1B,IAAMQ,EAAkBnC,KAAKC,MAC3BmC,aAAaC,QAAQC,IAEvBf,QAAQC,IAAIW,GACZI,EAAiBN,UAAY,GAE7B,IACEP,EAAwBS,E,CACxB,MAAOK,GACPjB,QAAQC,IAAIgB,EAAMC,Q,MA7IxBjC,EAASI,iBAAiB,SAkJ1B,WACEoB,EAAUC,UAAY,GACO,IAAzBF,EAAcJ,SAChB,EAAAC,EAAAC,gBAEF,GAAIK,EAAa,CACf,IAAMQ,EAAgB1C,KAAKC,MACzBmC,aAAaC,QAAQM,IAEvBJ,EAAiBN,UAAY,GAC7B,IACEP,EAAwBgB,E,CACxB,MAAOF,GACPjB,QAAQC,IAAIgB,EAAMC,Q,MA7JxBpC,EAAWO,iBAAiB,SAG5B,WACEP,EAAWuC,UAAUC,IAAI,aACzBrC,EAASoC,UAAUE,OAAO,Y,IAJ5BtC,EAASI,iBAAiB,SAO1B,WACEJ,EAASoC,UAAUC,IAAI,aACvBxC,EAAWuC,UAAUE,OAAO,Y,IA4C9B,IAAMd,EAAY1B,SAASC,cAAc,kBAEnCgC,GADUjC,SAASC,cAAc,qBACdD,SAASC,cAAc,yBAI1C+B,GAHahC,SAASC,cAAc,oBAGR,kBAC5BoC,EAA0B,eAC1BvB,EAAkBpB,KAAKC,MAC3BmC,aAAaC,QAAQC,IAGjBP,EAAgB/B,KAAKC,MAAMmC,aAAaC,QAAQM,IAChDT,EAAcd,EAAgB2B,OAAOhB,GAEjBG,EAAYc,QACpC,SAACC,EAAMC,EAAOC,G,OAAUA,EAAMC,QAAQH,KAAUC,C,IAQlD,SAASzB,EAAmB4B,EAAKnC,GAC/B,IAAMoC,EAAiBD,EAAIE,WAAU,SAAAC,G,OAAOA,EAAItC,KAAOA,C,IAMvD,OAJIoC,GAAiB,GACnBD,EAAII,OAAOH,EAAgB,GAGtBD,C,CA6ET,SAASK,EAAUC,GACjB,OAAOA,EAAUC,KAAI,SAAAC,G,OAASzB,aAAaC,QAAQwB,E,IAAQC,KAAK,K,CAGlE,SAASpC,EAAwBuB,GAC/B,IACIc,EAAa,GACbC,EAAc,IAClB,EAAAC,EAAAC,aACA,IAAMC,EAAoBlB,EACvBW,KACC,SAAAQ,G,IACEC,EAAWD,EAAXC,YACAC,EAAKF,EAALE,MACAC,EAAiBH,EAAjBI,UAAiBC,EAAAL,EACjBM,oBAAY,IAAAD,EAAG,GAAEA,EAAAE,EAAAP,EACjBQ,oBAAY,IAAAD,EAAG,GAAEA,EACjBzD,EAAEkD,EAAFlD,GA2BA,OAzBIqD,EAAO5C,OAAS,IAClB4C,EAAOd,OAAO,EAAGc,EAAO5C,OAAS,GAEjCoC,EAAaL,EAAUa,GACvBR,GAA0B,YAG5BA,EAAaL,EAAUa,IAER5C,OAAS,KACtB4C,EAAOM,MAEPd,EAAaL,EAAUa,GACvBR,GAA0B,WAGN,IAAlBQ,EAAO5C,SACToC,EAAa,oBAIK,MADpBC,EAAcU,EAAaI,MAAM,EAAG,MAElCd,EAAc,wBAGXK,EAgBI,WAEAtB,OAFW7B,EAAG,yDAEH6B,OAzDT,oCA6DgBA,OAJPsB,EAAY,uHAMAtB,OAFLuB,EAAM,oFAGLvB,OADIgB,EAAW,6CAEXhB,OADJiB,EAAY,iDACgBjB,OAAxB6B,EAAaG,QAAQ,GAAG,qDAzB/C,YAEAhC,OAFY7B,EAAG,sEAMG6B,OAJlBiC,EAAA9E,GAAM,uHAMiB6C,OAFLuB,EAAM,oFAGLvB,OADIgB,EAAW,6CAEXhB,OADJiB,EAAY,iDACgBjB,OAAxB6B,EAAaG,QAAQ,GAAG,oD,IAsB3DjB,KAAK,IACRvB,EAAiBN,UAAYkC,C,CAvK/BzC,EAAwBN,GACO,IAA3BA,EAAgBO,SAClB,EAAAC,EAAAC,e","sources":["node_modules/@parcel/runtime-js/lib/runtime-625dd5077a437416.js","node_modules/@parcel/runtime-js/lib/runtime-979de4d2464bac78.js","src/js/watched.js"],"sourcesContent":["require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"jtkoo\\\":\\\"library.97e13a6d.js\\\",\\\"DKcCc\\\":\\\"photo.e4714d22.jpg\\\",\\\"7mVsD\\\":\\\"index.20e08295.css\\\",\\\"imKXO\\\":\\\"index.39a9492c.js\\\"}\"));","module.exports = require('./helpers/bundle-url').getBundleURL('jtkoo') + require('./helpers/bundle-manifest').resolve(\"DKcCc\");","import photo from '../images/header/photo.jpg';\nimport { waitingLi } from './modalMovie';\nimport { emptyLibrary } from './library';\nimport { refs } from './refs';\nconst watchedBtn = document.querySelector('.watched-list-btn');\nconst queueBtn = document.querySelector('.queue-list-btn');\nrefs.addWatchedBtn.addEventListener('click', removeMovieFromWatched);\nrefs.addQueueBtn.addEventListener('click', removeMovieFromQueue);\nwatchedBtn.addEventListener('click', onWatchedClick);\nqueueBtn.addEventListener('click', onQueueClick);\n\nwatchedBtn.addEventListener('click', onWatched);\nqueueBtn.addEventListener('click', onQueueBtn);\n\nfunction onWatched() {\n  watchedBtn.classList.add('js-active');\n  queueBtn.classList.remove('js-active');\n}\n\nfunction onQueueBtn() {\n  queueBtn.classList.add('js-active');\n  watchedBtn.classList.remove('js-active');\n}\n\nimport { API_KEY, BASE_URL, TREND_URL, SEARCH_URL } from './api-vars.js';\n\nfunction createLibraryMarkup({\n  genres,\n  poster_path,\n  title,\n  release_date,\n  id,\n  vote_average,\n}) {\n  let genresArr = [];\n  genres.map(genre => genresArr.push(genre.name));\n  if (genresArr.length > 3) {\n    const changedArr = genresArr.slice(0, 2);\n    changedArr.push('Other');\n    genresArr = changedArr;\n  }\n  const genresStr = genresArr.join(', ');\n  const year = release_date.slice(0, 4);\n  const rating = vote_average.toFixed(1);\n  return `<li class=\"grid__item film-card \">\n        <a href=\"#\" data-id=\"${id}\" class=\"list\">\n          <div class=\"film-card__thumb\">\n            <img\n              class=\"film-card__img\"\n              src=\"${API_KEY}${poster_path}\"\n              alt=\"Movie poster\"\n              loading=\"lazy\"\n              id=${id}\n            />\n          </div>\n          <h2 class=\"film-card__header\">${title}</h2>\n        </a>\n        <p class=\"film-card__genres\">${genresStr}</p>\n        <span class=\"film-card__year\">${year}</span>\n        <span class=\"film-card__rating\">${rating}</span>\n      </li>`;\n}\n\n// рендер\n//const emptyLibrary = document.querySelector('.empty-library');\nconst container = document.querySelector('.empty-library');\nconst listLib = document.querySelector('.film-list-lib-js');\nconst listCardsLibrary = document.querySelector('.card__list--library');\nconst libraryBtn = document.querySelector('.library-default');\n// console.log(listCardsLibrary);\n\nconst LOCAL_STORAGE_KEY_WATCHED = 'watched-movies';\nconst LOCAL_STORAGE_KEY_QUEUE = 'queue-movies';\nconst saveDataWatched = JSON.parse(\n  localStorage.getItem(LOCAL_STORAGE_KEY_WATCHED)\n);\n\nconst saveDataQueue = JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY_QUEUE));\nconst saveDataAll = saveDataWatched.concat(saveDataQueue);\n\nconst savedDataAllQniue = saveDataAll.filter(\n  (data, index, array) => array.indexOf(data) === index\n);\n\nrenderMoviesFromLibrary(saveDataWatched);\nif (saveDataWatched.length === 0) {\n  emptyLibrary();\n}\n\nfunction removeObjectWithId(arr, id) {\n  const objWithIdIndex = arr.findIndex(obj => obj.id === id);\n\n  if (objWithIdIndex > -1) {\n    arr.splice(objWithIdIndex, 1);\n  }\n\n  return arr;\n}\n\nfunction removeMovieFromWatched(e) {\n  const forDeleteId = Number(e.target.dataset.id);\n  const idforRemovingFilm = saveDataWatched.find(film => {\n    if (forDeleteId === film.id) {\n      console.log(film.id);\n      return film.id;\n    }\n  });\n\n  removeObjectWithId(saveDataWatched, idforRemovingFilm.id);\n  renderMoviesFromLibrary(saveDataWatched);\n  if (saveDataWatched.length === 0) {\n    emptyLibrary();\n  }\n\n  // emptyLibrary();\n}\n\nfunction removeMovieFromQueue(e) {\n  const forDeleteId = Number(e.target.dataset.id);\n  const idforRemovingFilm = saveDataQueue.find(film => {\n    if (forDeleteId === film.id) {\n      console.log(film.id);\n      return film.id;\n    }\n  });\n\n  removeObjectWithId(saveDataQueue, idforRemovingFilm.id);\n  renderMoviesFromLibrary(saveDataQueue);\n  if (saveDataQueue.length === 0) {\n    emptyLibrary();\n  }\n}\n\nimport { renderTrendingMovies } from './filmCard';\n\nexport function onWatchedClick() {\n  container.innerHTML = '';\n  if (saveDataWatched.length === 0) {\n    emptyLibrary();\n  }\n  if (saveDataAll.length > 0) {\n    const saveDataWatched = JSON.parse(\n      localStorage.getItem(LOCAL_STORAGE_KEY_WATCHED)\n    );\n    console.log(saveDataWatched);\n    listCardsLibrary.innerHTML = '';\n\n    try {\n      renderMoviesFromLibrary(saveDataWatched);\n    } catch (error) {\n      console.log(error.message);\n    }\n  }\n}\n\nfunction onQueueClick() {\n  container.innerHTML = '';\n  if (saveDataQueue.length === 0) {\n    emptyLibrary();\n  }\n  if (saveDataAll) {\n    const saveDataQueue = JSON.parse(\n      localStorage.getItem(LOCAL_STORAGE_KEY_QUEUE)\n    );\n    listCardsLibrary.innerHTML = '';\n    try {\n      renderMoviesFromLibrary(saveDataQueue);\n    } catch (error) {\n      console.log(error.message);\n    }\n  }\n}\n\nfunction getGenres(genresArr) {\n  return genresArr.map(genre => localStorage.getItem(genre)).join(', ');\n}\n\nfunction renderMoviesFromLibrary(data) {\n  const urlImage = 'https://image.tmdb.org/t/p/w500/';\n  let genresName = '';\n  let releaseYear = '';\n  waitingLi();\n  const cardMarkupLibrary = data\n    .map(\n      ({\n        poster_path,\n        title,\n        genre_ids: genres,\n        release_date = '',\n        vote_average = '',\n        id,\n      }) => {\n        if (genres.length > 3) {\n          genres.splice(3, genres.length - 3);\n\n          genresName = getGenres(genres);\n          genresName = genresName + ', other';\n        }\n\n        genresName = getGenres(genres);\n\n        if (genresName.length > 24) {\n          genres.pop();\n\n          genresName = getGenres(genres);\n          genresName = genresName + ', other';\n        }\n\n        if (genres.length === 0) {\n          genresName = 'genre is unknown';\n        }\n\n        releaseYear = release_date.slice(0, 4);\n        if (releaseYear === '') {\n          releaseYear = 'release date unknown';\n        }\n\n        if (!poster_path) {\n          return `<li  id=\"${id}\" class=\"movie__card\">\n        <img width=\"100%\"\n          src=\"${photo}\"\n          class=\"movie__cover\"\n        />\n        <div class=\"movie__info\">\n        <h2 class=\"movie__title\">${title}</h2>\n        <div class=\"movie__item\">\n          <h3 class=\"movie__category\">${genresName}</h3>\n          <h3 class=\"movie__year\">${releaseYear}</h3>\n          <div class=\"movie__average\">${vote_average.toFixed(1)}</div>\n        </div>\n      </div>\n      </li>`;\n        } else {\n          return `<li id=\"${id}\" class=\"movie__card\">\n        <img\n          src=\"${urlImage}${poster_path}\"\n          class=\"movie__cover\"\n        />\n        <div class=\"movie__info\">\n        <h2 class=\"movie__title\">${title}</h2>\n        <div class=\"movie__item\">\n          <h3 class=\"movie__category\">${genresName}</h3>\n          <h3 class=\"movie__year\">${releaseYear}</h3>\n          <div class=\"movie__average\">${vote_average.toFixed(1)}</div>\n        </div>\n      </div>\n      </li>`;\n        }\n      }\n    )\n    .join('');\n  listCardsLibrary.innerHTML = cardMarkupLibrary;\n}\n"],"names":["parcelRequire","register","JSON","parse","$7e4ef6c3a5802a8f$exports","getBundleURL","resolve","$a215baf1061f969f$var$watchedBtn","document","querySelector","$a215baf1061f969f$var$queueBtn","$4Nugj","refs","addWatchedBtn","addEventListener","e","forDeleteId","Number","target","dataset","id","idforRemovingFilm","$a215baf1061f969f$var$saveDataWatched","find","film","console","log","$a215baf1061f969f$var$removeObjectWithId","$a215baf1061f969f$var$renderMoviesFromLibrary","length","$cHsZg","emptyLibrary","addQueueBtn","$a215baf1061f969f$var$saveDataQueue","$a215baf1061f969f$var$container","innerHTML","$a215baf1061f969f$var$saveDataAll","saveDataWatched1","localStorage","getItem","$a215baf1061f969f$var$LOCAL_STORAGE_KEY_WATCHED","$a215baf1061f969f$var$listCardsLibrary","error","message","saveDataQueue1","$a215baf1061f969f$var$LOCAL_STORAGE_KEY_QUEUE","classList","add","remove","concat","filter","data","index","array","indexOf","arr","objWithIdIndex","findIndex","obj","splice","$a215baf1061f969f$var$getGenres","genresArr","map","genre","join","genresName","releaseYear","$8AEpj","waitingLi","cardMarkupLibrary","param","poster_path","title","genres","genre_ids","_release_date","release_date","_vote_average","vote_average","pop","slice","toFixed","$parcel$interopDefault"],"version":3,"file":"library.97e13a6d.js.map"}